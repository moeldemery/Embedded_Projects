/*
 * DIO_driver.c
 *
 *  Created on: 14 Jan 2020
 *      Author: Mohamed
 */
//#include "../../MCAL/INC/DIO_driver.h"
#include "../../UTILITIES/STD_TYPES.h"
#include "../../UTILITIES/BIT_MATH.h"
#include "DIO_driver.h"


DIO_config_t DIO_groups [DIO_Number_of_groups]=
{
	{PORTD, 0b10000000, OUTPUT 	,PULL_UP_DISABLE	},		/*led 		1 group*/
	{PORTD, 0b11000000, OUTPUT	,PULL_UP_DISABLE	},
	{PORTD, 0b00000001, INPUT  	,PULL_UP_ENABLE		},		/*BTN 		3 group*/
	{PORTC, 0b11110000, OUTPUT  ,PULL_UP_DISABLE	},		/*SEG1 		4 group*/
	{PORTC, 0b00001100, OUTPUT  ,PULL_UP_DISABLE	},		/*SEG1_EN 	5 group*/
	{PORTC, 0b00001000, OUTPUT  ,PULL_UP_DISABLE	}		/*SEG2_EN 	6 group*/
};


void DIO_Init	(void)
{
	u8 i=0;
	for(i=0;i<DIO_Number_of_groups;i++)
	{

		DDR( GRP_PORT(i) )  &= ~ ( GRP_MASK(i) ) ;							/*ddr = reset(mask)*/

		DDR( GRP_PORT(i) ) 	|=  (GRP_DIR(i)  &  GRP_MASK(i));		/*ddr = set(dir & mask)*/

		/*port = reset(mask)*/
		PORT( GRP_PORT(i) )	&= ~( GRP_MASK(i) );
		/*port = set(pull up & mask & ~dir)*/
		PORT( GRP_PORT(i) )	 |=  ( GRP_PULL(i) 	&  GRP_MASK(i) & ( ~GRP_DIR(i) ) );
	}

}
void DIO_Write 	(u8 data, u8 Group_id)
{
	u8 Copy_portValue 	= PORT( GRP_PORT(Group_id));

	Copy_portValue 		&= ~( GRP_MASK(Group_id) );
	Copy_portValue 		|=  (GRP_MASK(Group_id) & data );

	PORT( GRP_PORT(Group_id))	= Copy_portValue;
}

u8   DIO_Read	(u8 Group_id)
{
	/*RETURN PIN & MASK */
	return ( PIN(DIO_groups[Group_id].port_id)   &   DIO_groups[Group_id].mask ) ;
}


